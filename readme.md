# Загрузчик MQTT-сообщений в СУБД "PostgreSQL".


## Описание

- По представляет из себя MQTT-Клиент, который считывает сообщения с MQTT-брокера.
- Для хранения сообщений используется СУБД PostgreSQL.
- Подсистема хранения результатов (показаний датчиков) реализована с использованием расширения TimeScaleDB.

### Описание ПО:

- Проект MQTT2PSQL_LOADER реализован на языке GO 1.22.2.
- В проекте используется библиотека MQTT-Клиент "Eclipse Paho MQTT 3.1/3.11 Go client library".
- Исполняемый модуль собран и испытан на платформе Linux Ubuntu 24.04.
- Для настройки используются переменные окружения и файл конфигурации формата YAML.

### Объекты базы данных:

|       Объект       |   Тип   |                                      Назначение                                       |
|--------------------|---------|---------------------------------------------------------------------------------------|
| events             | Таблица | Таблица исходных mqtt-сообщений (подсистема загрузки)                                 |
| after_insert_event | Триггер | Триггер (AFTER INSERT) для запуска функции переноса результатов в подсистему хранения |
| event_after_insert | Функция | Функция переноса результатов подсистему хранения                                      |

### Состав файлов для развертывания и запуска:

| Файл                                       | Описание                                                  |
|--------------------------------------------|-----------------------------------------------------------|
| ../MQTT2PSQL_LOADER/bin/mqtt2psql_loader   | Загрузчик (исполняемый модуль)                            |
| ../MQTT2PSQL_LOADER/config/config.yaml     | Файл конфигурации                                         |
| ../SQL/create_mqtt2psql_loader_schema1.sql | SQL-скрипт (подсистема загрузки сообщений)                |
| ../SQL/create_schema.sql                   | SQL-скрипт (подсистемы хранения результатов часть 1)      |
| ../SQL/create_schema1.sql                  | SQL-скрипт (подсистемы хранения результатов часть 2)      |
| ../SQL/create_test_schema.sql              | SQL-скрипт (тестовая схема подсистемы хранения)           |
| ../SQL/load_test_data.sql                  | SQL-скрипт (загрузка тестовых сообщений для тестирования) |
| ../SQL/messages.csv                        | CSV-файл (тестовые сообщения)                             |
| ../SQL/print_result_schema1.sql            | SQL-скрипт (вывод результатов тестирования)               |





